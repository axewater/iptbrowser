<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Manager - IPTorrents Browser</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cookie_manager.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <a href="/" class="btn btn-back">‚Üê Back to Browser</a>
                <div class="header-title">
                    <h1>Cookie Manager</h1>
                    <p class="subtitle">Manage IPTorrents authentication cookies</p>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="cookie-manager-content">

            <!-- Cookie Status Card -->
            <section class="card">
                <h2>Current Cookie Status</h2>
                <div id="cookie-status" class="status-container">
                    <div class="loading">Loading status...</div>
                </div>
            </section>

            <!-- View/Edit Cookie Card -->
            <section class="card">
                <h2>Cookie Value</h2>
                <div class="cookie-display">
                    <div class="form-group">
                        <label for="cookie-value">Cookie:</label>
                        <div class="cookie-input-container">
                            <textarea
                                id="cookie-value"
                                class="input-field cookie-textarea"
                                rows="3"
                                readonly
                                placeholder="No cookie configured"
                            ></textarea>
                            <button id="toggle-mask-btn" class="btn btn-icon" title="Show/Hide">
                                <span class="icon">üëÅÔ∏è</span>
                            </button>
                        </div>
                    </div>
                    <div class="button-group">
                        <button id="edit-cookie-btn" class="btn btn-secondary">Edit Cookie</button>
                        <button id="save-cookie-btn" class="btn btn-primary" style="display: none;">Save Changes</button>
                        <button id="cancel-edit-btn" class="btn btn-secondary" style="display: none;">Cancel</button>
                    </div>
                </div>
            </section>

            <!-- Test Cookie Card -->
            <section class="card">
                <h2>Cookie Validation</h2>
                <div class="validation-section">
                    <p>Test your cookie to ensure it's valid and working correctly.</p>
                    <button id="test-cookie-btn" class="btn btn-primary">
                        <span class="btn-text">Test Cookie</span>
                        <span class="btn-loading" style="display: none;">Testing...</span>
                    </button>
                    <div id="test-result" class="test-result" style="display: none;">
                        <!-- Test results populated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- Manual Cookie Extraction -->
            <section class="card">
                <h2>How to Get Your Cookie</h2>
                <div class="manual-instructions">
                    <div class="info-box" style="margin-bottom: 1.5rem; background-color: #fff3cd; border-color: #ffc107;">
                        <strong>Note:</strong> Modern browsers use app-bound encryption that prevents automatic cookie extraction by external tools. You'll need to manually copy your cookie from your browser.
                    </div>

                    <h3>Step-by-Step Instructions:</h3>
                    <ol style="line-height: 2;">
                        <li>
                            <strong>Open IPTorrents in your browser:</strong><br>
                            Navigate to <a href="https://iptorrents.com" target="_blank" rel="noopener">iptorrents.com</a> and make sure you're logged in
                        </li>
                        <li>
                            <strong>Open Developer Tools:</strong><br>
                            Press <kbd>F12</kbd> or right-click anywhere and select "Inspect"
                        </li>
                        <li>
                            <strong>Navigate to Cookies:</strong><br>
                            ‚Ä¢ <strong>Chrome/Edge:</strong> Click the <strong>Application</strong> tab ‚Üí <strong>Cookies</strong> ‚Üí select the IPTorrents domain<br>
                            ‚Ä¢ <strong>Firefox:</strong> Click the <strong>Storage</strong> tab ‚Üí <strong>Cookies</strong> ‚Üí select the IPTorrents domain
                        </li>
                        <li>
                            <strong>Find the required cookies:</strong><br>
                            Look for two cookies named <code>uid</code> and <code>pass</code> in the cookie list
                        </li>
                        <li>
                            <strong>Copy the values:</strong><br>
                            Click on each cookie and copy its <strong>Value</strong> field
                        </li>
                        <li>
                            <strong>Format the cookie string:</strong><br>
                            Combine them in this format: <code>uid=YOUR_UID_VALUE; pass=YOUR_PASS_VALUE</code>
                        </li>
                        <li>
                            <strong>Save to IPT Browser:</strong><br>
                            Paste the formatted cookie into the "Cookie Value" field above, then click "Edit Cookie" and "Save Changes"
                        </li>
                    </ol>

                    <div class="example-box" style="margin-top: 1.5rem;">
                        <strong>Example cookie format:</strong><br>
                        <code style="font-size: 14px;">uid=451419; pass=ee512bb151e63b20e8debc35efdf7493</code>
                    </div>

                    <div class="info-box" style="margin-top: 1.5rem;">
                        <h4>Troubleshooting:</h4>
                        <ul>
                            <li>Make sure you're logged into IPTorrents before checking for cookies</li>
                            <li>The domain might be listed as <strong>.iptorrents.com</strong> or <strong>www.iptorrents.com</strong></li>
                            <li>If you don't see the cookies, try refreshing the page while DevTools is open</li>
                            <li>Cookie values are case-sensitive, make sure to copy them exactly</li>
                        </ul>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <script src="{{ url_for('static', filename='js/cookie_manager.js') }}"></script>
</body>
</html>
